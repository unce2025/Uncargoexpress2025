<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Admin Panel - United Nation Cargo Express</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; }
  label { display: block; margin-top: 10px; font-weight: bold; }
  input, textarea { width: 100%; padding: 6px; margin-top: 4px; box-sizing: border-box; }
  button { margin-top: 15px; padding: 10px 20px; }
</style>
</head>
<body>

<h1>Admin Panel - United Nation Cargo Express</h1>

<form id="adminForm" onsubmit="return false;">
  <label for="trackingNumber">Tracking Number</label>
  <input id="trackingNumber" type="text" placeholder="Tracking Number" />

  <label for="status">Status</label>
  <input id="status" type="text" placeholder="Status" />

  <label for="shipperName">Shipper Name</label>
  <input id="shipperName" type="text" placeholder="Shipper Name" />

  <label for="shipperPhone">Shipper Phone</label>
  <input id="shipperPhone" type="text" placeholder="Shipper Phone" />

  <label for="shipperAddress">Shipper Address</label>
  <input id="shipperAddress" type="text" placeholder="Shipper Address" />

  <label for="shipperEmail">Shipper Email</label>
  <input id="shipperEmail" type="email" placeholder="Shipper Email" />

  <label for="receiverName">Receiver Name</label>
  <input id="receiverName" type="text" placeholder="Receiver Name" />

  <label for="receiverPhone">Receiver Phone</label>
  <input id="receiverPhone" type="text" placeholder="Receiver Phone" />

  <label for="receiverAddress">Receiver Address</label>
  <input id="receiverAddress" type="text" placeholder="Receiver Address" />

  <label for="receiverEmail">Receiver Email</label>
  <input id="receiverEmail" type="email" placeholder="Receiver Email" />

  <label for="estimatedDeliveryDate">Estimated Delivery Date</label>
  <input id="estimatedDeliveryDate" type="date" />

  <label for="shippedDate">Shipped Date</label>
  <input id="shippedDate" type="date" />

  <label for="pickUpTime">Pick Up Time</label>
  <input id="pickUpTime" type="time" />

  <label for="departure">Departure</label>
  <input id="departure" type="text" placeholder="Departure" />

  <label for="mode">Mode</label>
  <input id="mode" type="text" placeholder="Mode" />

  <label for="product">Product</label>
  <input id="product" type="text" placeholder="Product" />

  <label for="quantity">Quantity</label>
  <input id="number" id="quantity" type="number" min="1" placeholder="Quantity" />

  <label for="payment">Payment</label>
  <input id="payment" type="text" placeholder="Payment" />

  <label for="totalFreight">Total Freight</label>
  <input id="totalFreight" type="text" placeholder="Total Freight" />

  <label for="log">Log</label>
  <textarea id="log" rows="4" placeholder="Log details here..."></textarea>

  <label for="history">History</label>
  <textarea id="history" rows="4" placeholder="History details here..."></textarea>

  <button id="searchBtn" type="button">Search Shipment</button>
  <button id="saveBtn" type="button">Save Shipment</button>
  <button id="newBtn" type="button">New Shipment</button>
</form>

<script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwPDSYFvy0iburNNHhbsQ6sEPVOW_EMDSLh1mP9A_nxCZ_S3IrVuAvnHaV5rgzJMv6k/exec"; // <-- Put your Google Apps Script URL here

  // Utility: get form data as object
  function getFormData() {
    return {
      trackingNumber: document.getElementById('trackingNumber').value.trim(),
      status: document.getElementById('status').value.trim(),
      shipperName: document.getElementById('shipperName').value.trim(),
      shipperPhone: document.getElementById('shipperPhone').value.trim(),
      shipperAddress: document.getElementById('shipperAddress').value.trim(),
      shipperEmail: document.getElementById('shipperEmail').value.trim(),
      receiverName: document.getElementById('receiverName').value.trim(),
      receiverPhone: document.getElementById('receiverPhone').value.trim(),
      receiverAddress: document.getElementById('receiverAddress').value.trim(),
      receiverEmail: document.getElementById('receiverEmail').value.trim(),
      estimatedDeliveryDate: document.getElementById('estimatedDeliveryDate').value,
      shippedDate: document.getElementById('shippedDate').value,
      pickUpTime: document.getElementById('pickUpTime').value,
      departure: document.getElementById('departure').value.trim(),
      mode: document.getElementById('mode').value.trim(),
      product: document.getElementById('product').value.trim(),
      quantity: document.getElementById('quantity').value.trim(),
      payment: document.getElementById('payment').value.trim(),
      totalFreight: document.getElementById('totalFreight').value.trim(),
      log: document.getElementById('log').value.trim(),
      history: document.getElementById('history').value.trim(),
    };
  }

  // Utility: fill form from data object
  function fillForm(data) {
    if (!data) return alert('No shipment data found.');
    document.getElementById('trackingNumber').value = data.trackingNumber || "";
    document.getElementById('status').value = data.status || "";
    document.getElementById('shipperName').value = data.shipperName || "";
    document.getElementById('shipperPhone').value = data.shipperPhone || "";
    document.getElementById('shipperAddress').value = data.shipperAddress || "";
    document.getElementById('shipperEmail').value = data.shipperEmail || "";
    document.getElementById('receiverName').value = data.receiverName || "";
    document.getElementById('receiverPhone').value = data.receiverPhone || "";
    document.getElementById('receiverAddress').value = data.receiverAddress || "";
    document.getElementById('receiverEmail').value = data.receiverEmail || "";
    document.getElementById('estimatedDeliveryDate').value = data.estimatedDeliveryDate || "";
    document.getElementById('shippedDate').value = data.shippedDate || "";
    document.getElementById('pickUpTime').value = data.pickUpTime || "";
    document.getElementById('departure').value = data.departure || "";
    document.getElementById('mode').value = data.mode || "";
    document.getElementById('product').value = data.product || "";
    document.getElementById('quantity').value = data.quantity || "";
    document.getElementById('payment').value = data.payment || "";
    document.getElementById('totalFreight').value = data.totalFreight || "";
    document.getElementById('log').value = data.log || "";
    document.getElementById('history').value = data.history || "";
  }

  // Clear form inputs
  function clearForm() {
    fillForm({});
  }

  // Search shipment by tracking number
  async function searchShipment() {
    const trackingNumber = document.getElementById('trackingNumber').value.trim();
    if (!trackingNumber) {
      alert('Please enter a tracking number to search.');
      return;
    }
    try {
      const response = await fetch(`${SCRIPT_URL}?trackingNumber=${encodeURIComponent(trackingNumber)}`);
      const result = await response.json();
      if (result.shipment) {
        fillForm(result.shipment);
        alert('Shipment found and loaded.');
      } else {
        alert('Shipment not found.');
        clearForm();
        document.getElementById('trackingNumber').value = trackingNumber; // keep tracking number entered
      }
    } catch (err) {
      alert('Error fetching shipment data: ' + err.message);
    }
  }

  // Save shipment (add new or update)
  async function saveShipment() {
    const data = getFormData();
    if (!data.trackingNumber) {
      alert('Tracking Number is required.');
      return;
    }
    try {
      const response = await fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ shipment: data }),
        headers: {
          'Content-Type': 'application/json',
        },
      });
      const result = await response.json();
      if (result.success) {
        alert('Shipment saved successfully.');
      } else {
        alert('Failed to save shipment.');
      }
    } catch (err) {
      alert('Error saving shipment: ' + err.message);
    }
  }

  // New shipment button clears form
  function newShipment() {
    if (confirm('Clear form to add new shipment? Unsaved changes will be lost.')) {
      clearForm();
    }
  }

  // Setup event listeners after DOM loads
  document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('searchBtn').addEventListener('click', searchShipment);
    document.getElementById('saveBtn').addEventListener('click', saveShipment);
    document.getElementById('newBtn').addEventListener('click', newShipment);
  });
</script>

</body>
</html>
